#' @source \url{http://matsucon.net/material/dic/}
atm <- readr::read_csv(box::file("atm.csv"), show_col_types = FALSE)
atm <- purrr::set_names(atm$kao, atm$name)

source <- "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789" |>
  stringi::stri_split_boundaries(type = "character") |>
  purrr::flatten_chr()

font <- list(
  bold = "ðšð›ðœððžðŸð ð¡ð¢ð£ð¤ð¥ð¦ð§ð¨ð©ðªð«ð¬ð­ð®ð¯ð°ð±ð²ð³ð€ðð‚ðƒð„ð…ð†ð‡ðˆð‰ðŠð‹ðŒððŽððð‘ð’ð“ð”ð•ð–ð—ð˜ð™ðŸŽðŸðŸðŸ‘ðŸ’ðŸ“ðŸ”ðŸ•ðŸ–ðŸ—",
  italic = "ð‘Žð‘ð‘ð‘‘ð‘’ð‘“ð‘”â„Žð‘–ð‘—ð‘˜ð‘™ð‘šð‘›ð‘œð‘ð‘žð‘Ÿð‘ ð‘¡ð‘¢ð‘£ð‘¤ð‘¥ð‘¦ð‘§ð´ðµð¶ð·ð¸ð¹ðºð»ð¼ð½ð¾ð¿ð‘€ð‘ð‘‚ð‘ƒð‘„ð‘…ð‘†ð‘‡ð‘ˆð‘‰ð‘Šð‘‹ð‘Œð‘0123456789",
  boldItalic = "ð’‚ð’ƒð’„ð’…ð’†ð’‡ð’ˆð’‰ð’Šð’‹ð’Œð’ð’Žð’ð’ð’‘ð’’ð’“ð’”ð’•ð’–ð’—ð’˜ð’™ð’šð’›ð‘¨ð‘©ð‘ªð‘«ð‘¬ð‘­ð‘®ð‘¯ð‘°ð‘±ð‘²ð‘³ð‘´ð‘µð‘¶ð‘·ð‘¸ð‘¹ð‘ºð‘»ð‘¼ð‘½ð‘¾ð‘¿ð’€ð’0123456789",
  sans = "ð–ºð–»ð–¼ð–½ð–¾ð–¿ð—€ð—ð—‚ð—ƒð—„ð—…ð—†ð—‡ð—ˆð—‰ð—Šð—‹ð—Œð—ð—Žð—ð—ð—‘ð—’ð—“ð– ð–¡ð–¢ð–£ð–¤ð–¥ð–¦ð–§ð–¨ð–©ð–ªð–«ð–¬ð–­ð–®ð–¯ð–°ð–±ð–²ð–³ð–´ð–µð–¶ð–·ð–¸ð–¹ðŸ¢ðŸ£ðŸ¤ðŸ¥ðŸ¦ðŸ§ðŸ¨ðŸ©ðŸªðŸ«",
  boldSans = "ð—®ð—¯ð—°ð—±ð—²ð—³ð—´ð—µð—¶ð—·ð—¸ð—¹ð—ºð—»ð—¼ð—½ð—¾ð—¿ð˜€ð˜ð˜‚ð˜ƒð˜„ð˜…ð˜†ð˜‡ð—”ð—•ð—–ð——ð—˜ð—™ð—šð—›ð—œð—ð—žð—Ÿð— ð—¡ð—¢ð—£ð—¤ð—¥ð—¦ð—§ð—¨ð—©ð—ªð—«ð—¬ð—­ðŸ¬ðŸ­ðŸ®ðŸ¯ðŸ°ðŸ±ðŸ²ðŸ³ðŸ´ðŸµ",
  italicSans = "ð˜¢ð˜£ð˜¤ð˜¥ð˜¦ð˜§ð˜¨ð˜©ð˜ªð˜«ð˜¬ð˜­ð˜®ð˜¯ð˜°ð˜±ð˜²ð˜³ð˜´ð˜µð˜¶ð˜·ð˜¸ð˜¹ð˜ºð˜»ð˜ˆð˜‰ð˜Šð˜‹ð˜Œð˜ð˜Žð˜ð˜ð˜‘ð˜’ð˜“ð˜”ð˜•ð˜–ð˜—ð˜˜ð˜™ð˜šð˜›ð˜œð˜ð˜žð˜Ÿð˜ ð˜¡ðŸ¬ðŸ­ðŸ®ðŸ¯ðŸ°ðŸ±ðŸ²ðŸ³ðŸ´ðŸµ",
  boldItalicSans = "ð™–ð™—ð™˜ð™™ð™šð™›ð™œð™ð™žð™Ÿð™ ð™¡ð™¢ð™£ð™¤ð™¥ð™¦ð™§ð™¨ð™©ð™ªð™«ð™¬ð™­ð™®ð™¯ð˜¼ð˜½ð˜¾ð˜¿ð™€ð™ð™‚ð™ƒð™„ð™…ð™†ð™‡ð™ˆð™‰ð™Šð™‹ð™Œð™ð™Žð™ð™ð™‘ð™’ð™“ð™”ð™•ðŸ¬ðŸ­ðŸ®ðŸ¯ðŸ°ðŸ±ðŸ²ðŸ³ðŸ´ðŸµ",
  script = "ð’¶ð’·ð’¸ð’¹â„¯ð’»â„Šð’½ð’¾ð’¿ð“€ð“ð“‚ð“ƒâ„´ð“…ð“†ð“‡ð“ˆð“‰ð“Šð“‹ð“Œð“ð“Žð“ð’œâ„¬ð’žð’Ÿâ„°â„±ð’¢â„‹â„ð’¥ð’¦â„’â„³ð’©ð’ªð’«ð’¬â„›ð’®ð’¯ð’°ð’±ð’²ð’³ð’´ð’µ0123456789",
  boldScript = "ð“ªð“«ð“¬ð“­ð“®ð“¯ð“°ð“±ð“²ð“³ð“´ð“µð“¶ð“·ð“¸ð“¹ð“ºð“»ð“¼ð“½ð“¾ð“¿ð”€ð”ð”‚ð”ƒð“ð“‘ð“’ð““ð“”ð“•ð“–ð“—ð“˜ð“™ð“šð“›ð“œð“ð“žð“Ÿð“ ð“¡ð“¢ð“£ð“¤ð“¥ð“¦ð“§ð“¨ð“©0123456789",
  fraktur = "ð”žð”Ÿð” ð”¡ð”¢ð”£ð”¤ð”¥ð”¦ð”§ð”¨ð”©ð”ªð”«ð”¬ð”­ð”®ð”¯ð”°ð”±ð”²ð”³ð”´ð”µð”¶ð”·ð”„ð”…â„­ð”‡ð”ˆð”‰ð”Šâ„Œâ„‘ð”ð”Žð”ð”ð”‘ð”’ð”“ð””â„œð”–ð”—ð”˜ð”™ð”šð”›ð”œâ„¨0123456789",
  boldFraktur = "ð–†ð–‡ð–ˆð–‰ð–Šð–‹ð–Œð–ð–Žð–ð–ð–‘ð–’ð–“ð–”ð–•ð––ð–—ð–˜ð–™ð–šð–›ð–œð–ð–žð–Ÿð•¬ð•­ð•®ð•¯ð•°ð•±ð•²ð•³ð•´ð•µð•¶ð•·ð•¸ð•¹ð•ºð•»ð•¼ð•½ð•¾ð•¿ð–€ð–ð–‚ð–ƒð–„ð–…0123456789",
  monospace = "ðšŠðš‹ðšŒðšðšŽðšðšðš‘ðš’ðš“ðš”ðš•ðš–ðš—ðš˜ðš™ðššðš›ðšœðšðšžðšŸðš ðš¡ðš¢ðš£ð™°ð™±ð™²ð™³ð™´ð™µð™¶ð™·ð™¸ð™¹ð™ºð™»ð™¼ð™½ð™¾ð™¿ðš€ðšðš‚ðšƒðš„ðš…ðš†ðš‡ðšˆðš‰ðŸ¶ðŸ·ðŸ¸ðŸ¹ðŸºðŸ»ðŸ¼ðŸ½ðŸ¾ðŸ¿",
  blackboard = "ð•’ð•“ð•”ð••ð•–ð•—ð•˜ð•™ð•šð•›ð•œð•ð•žð•Ÿð• ð•¡ð•¢ð•£ð•¤ð•¥ð•¦ð•§ð•¨ð•©ð•ªð•«ð”¸ð”¹â„‚ð”»ð”¼ð”½ð”¾â„ð•€ð•ð•‚ð•ƒð•„â„•ð•†â„™â„šâ„ð•Šð•‹ð•Œð•ð•Žð•ð•â„¤ðŸ˜ðŸ™ðŸšðŸ›ðŸœðŸðŸžðŸŸðŸ ðŸ¡"
) |>
  purrr::map(~ unlist(stringi::stri_split_boundaries(., type = "character"))) |>
  purrr::map(~ purrr::set_names(., source))

atm_transformer <- function(text, envir) {
  idx <- which(names(atm) == text)
  if (length(idx) > 0) {
    sample(atm[idx], size = 1L)
  } else {
    ""
  }
}

#' Call glue replacing kaomoji
#' @param ... passed to \code{glue::glue}
#' @param .envir environment
#' @export
kaomoji <- function(..., .envir = parent.frame()) {
  glue::glue(..., .open = "@", .close = "@", .envir = .envir, .transformer = atm_transformer)
}

#' Convert alphanumeric characters into various styles
#' @param text character vector
#' @param style string
#' @export
omekasy <- function(text,
                    style = c(
                      "bold",
                      "italic",
                      "boldItalic",
                      "sans",
                      "boldSans",
                      "italicSans",
                      "boldItalicSans",
                      "script",
                      "boldScript",
                      "fraktur",
                      "boldFraktur",
                      "monospace",
                      "blackboard"
                    )) {
  style <- match.arg(style)
  f <- font[[style]]
  stringi::stri_replace_all_regex(
    text,
    pattern = names(f),
    replacement = f,
    vectorize_all = FALSE
  )
}

#' @export
accelerate <- function(text = "ç²¾ç¥žã‚’åŠ é€Ÿã•ã›ã‚") {
  r"(
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€âˆ©ï¼¿âˆ©
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ ï¼ ï¼¼ ï¼ï¼¼
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€|ï¼ˆï¾Ÿï¼‰=ï¼ˆï¾Ÿï¼‰|
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€|ã€€ã€€â—_â—ã€€ |
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€/ã€€ã€€ã€€ã€€ã€€ã€€ãƒ½
ã€€ã€€ã€€ã€€ã€€ã€€ã€€râŒ’| ã€ƒ ------ ãƒ¾ã€€|
ã€€ã€€ã€€ã€€ã€€ã€€/ã€€ã€€iï¼ã€€|ï¼¿äºŒï¼¿ï¼¿ãƒŽ
ã€€ã€€ã€€ã€€ã€€./ã€€ ï¼ã€€ã€€/ã€€ã€€ã€€ã€€ã€€ã€€) ã€€ã€€ã€€  {text}
ã€€ã€€ã€€ã€€ ./ ï¼ã€€ã€€ï¼ã€€ã€€ã€€ã€€ ã€€/ï¼
ã€€ã€€ã€€ã€€/ã€€ã€€ã€€.ï¼ã€€ã€€ã€€ã€€ã€€/ï¿£
ã€€ã€€ã€€ .ãƒ½ï½¤__.ï¼ã€€ã€€ã€€ã€€ ï¼ âŒ’ãƒ½
ã€€ã€€ ã€€ã€€ã€€ã€€ rã€€ã€€ã€€ ï¼ã€€ ã€€ã€€ã€€|
ã€€ã€€ã€€ã€€ã€€ã€€/ã€€ã€€ ã€€ã€€ã€€ã€€ã€€ã€€ã€€ï¾‰
ã€€ã€€ã€€ã€€ã€€/ã€€ã€€ã€€ã€€ã€€ /ã€€ã€€ã€€ /
ã€€ã€€ã€€ã€€./ã€€ã€€ã€€ã€€ï¼/ã€€ã€€ ï¼
ã€€ã€€ã€€ /.ã€€ã€€ã€€.ï¼ ./ã€€ ï¼
ã€€ã€€ã€€iã€€ã€€ã€€ï¼ã€€./ ï¼
ã€€ã€€ã€€iã€€ã€€./ã€€.ãƒŽ.ï¼¾/
ã€€ã€€ã€€iã€€ ./ã€€ã€€|_ï¼
ã€€ã€€ã€€iã€€/
ã€€ã€€ï¼ /
ã€€ (_ï¼
  )" |> stringi::stri_replace_all_fixed("ã€€", "  ") |> glue::glue()
}

#' @export
qb <- function(text = "ã‚ã‘ãŒã‚ã‹ã‚‰ãªã„ã‚ˆ") {
  r"(
ã€€ ã€€ ã€€ ã€€ |ï¼¼ã€€ã€€ ã€€ ã€€ ã€€ ã€€ ï¼|
ã€€ ã€€ ã€€ ã€€ |ï¼¼ï¼¼ã€€ã€€ ã€€ ã€€ ï¼ï¼|
ã€€ã€€ã€€ã€€ ã€€ : ã€€,>ã€€ï½€Â´ï¿£ï½€Â´ã€€<ã€€ â€²
.ã€€ã€€ã€€ã€€ ã€€ ï¼¶ã€€ ã€€ ã€€ ã€€ ã€€ ã€€ ï¼¶
.ã€€ã€€ã€€ã€€ ã€€ i<ã€€â—ã€€ ã€€ ã€€ â—ã€€>i
ã€€ã€€ã€€ã€€ ã€€ å…«ã€€ ã€€ ï½¤_,_, ã€€ ã€€ å…« ã€€ã€€ã€€{text}
. ã€€ ã€€ ã€€ /ã€€ä¸ª . ï¼¿ã€€ ï¼¿ . ä¸ª ',
ã€€ã€€ã€€ï¼¿/ ã€€ il ã€€ ,'ã€€ã€€ã€€ '.ã€€ liã€€ ',ï¼¿_
  )" |> stringi::stri_replace_all_fixed("ã€€", "  ") |> glue::glue()
}
